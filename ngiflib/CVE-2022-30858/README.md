# CVE-2022-30858
The program `SDLaffgif` in library `ngiflib` crashes when opening a crafted file.

## Test Environment
Ubuntu 16.04, 64bit  
ngiflib(master 0245fd4)

## How to trigger
1. Compile the program with AddressSanitizer: `CC="clang -fsanitize=address -g" CFLAGS+=-DNGIFLIB_NO_FILE make`
2. run the compiled program with given [POC file](https://raw.githubusercontent.com/Marsman1996/pocs/master/ngiflib/CVE-2022-30858/poc-SDLaffgif-0245fd4-SDL_LoadAnimatedGif-SEGV): `$ ./SDLaffgif $POC`

## Reference
https://github.com/miniupnp/ngiflib/issues/22  
https://cve.mitre.org/cgi-bin/cvename.cgi?name=2022-30858
## Credits
ZhangZheng(zhengzhangos@outlook.com)  
Marsman1996(lqliuyuwei@outlook.com)  
Yanhao(unfuzzable123@gmail.com)  

## Details

### ASAN report
```
AddressSanitizer:DEADLYSIGNAL
=================================================================
==17292==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x0000004c9d16 bp 0x7ffeb82f9750 sp 0x7ffeb82f9690 T0)
==17292==The signal is caused by a READ memory access.
==17292==Hint: address points to the zero page.
    #0 0x4c9d16 in SDL_LoadAnimatedGif /opt/disk/marsman/ngiflib/0245fd4/build_asan/ngiflibSDL.c:177:63
    #1 0x4c875f in main /opt/disk/marsman/ngiflib/0245fd4/build_asan/SDLaffgif.c:107:14
    #2 0x7f305d6bf83f in __libc_start_main /build/glibc-S7Ft5T/glibc-2.23/csu/../csu/libc-start.c:291
    #3 0x41bd38 in _start (/opt/disk/marsman/ngiflib/0245fd4/bin_asan/bin/SDLaffgif+0x41bd38)

AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: SEGV /opt/disk/marsman/ngiflib/0245fd4/build_asan/ngiflibSDL.c:177:63 in SDL_LoadAnimatedGif
==17292==ABORTING
```